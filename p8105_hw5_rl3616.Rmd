---
title: "p8105_hw5_rl3616"
author: "Ruipeng Li"
date: "`r format(Sys.Date())`"
output: github_document
---

```{r}
library(tidyverse)
set.seed(123)
```

### Problem 1

```{r}
has_duplicate_birthday <- function(n) {
  b <- sample(1:365, size = n, replace = TRUE)
  any(duplicated(b))
  }
group_size = 2:50
n_sim = 10000

results <- map_df(
  group_size,
  ~ tibble(
    n = .x, 
    dup = replicate(n_sim, has_duplicate_birthday(.x))
    )
  )

prob_by_n <- results |>
  group_by(n) |> 
  summarise(prob_dup = mean(dup), .groups = "drop")

prob_by_n
```

```{r}
ggplot(prob_by_n, aes(x = n, y = prob_dup)) +
  geom_line() +
  geom_point() +
  labs(
    x = "Group size (n)",
    y = "P(at least two share a birthday)",
    title = "Birthday Duplicate Simulation"
    ) +
  theme_minimal()
```  
As shown in the plot, when the group size is very small, the probability of having a shared birthday is close to zero. As the group size increases, the probability rises rapidly. Around a group size of 25, the rate of increase begins to slow down, and eventually the probability approaches 100%.

