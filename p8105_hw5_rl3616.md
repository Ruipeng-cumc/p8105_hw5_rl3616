p8105_hw5_rl3616
================
Ruipeng Li
2025-11-13

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.2
    ## ✔ ggplot2   4.0.0     ✔ tibble    3.3.0
    ## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1
    ## ✔ purrr     1.1.0     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
set.seed(123)
```

### Problem 1

``` r
has_duplicate_birthday <- function(n) {
  b <- sample(1:365, size = n, replace = TRUE)
  any(duplicated(b))
  }
group_size = 2:50
n_sim = 10000

results <- map_df(
  group_size,
  ~ tibble(
    n = .x, 
    dup = replicate(n_sim, has_duplicate_birthday(.x))
    )
  )

prob_by_n <- results |>
  group_by(n) |> 
  summarise(prob_dup = mean(dup), .groups = "drop")

prob_by_n
```

    ## # A tibble: 49 × 2
    ##        n prob_dup
    ##    <int>    <dbl>
    ##  1     2   0.0033
    ##  2     3   0.0079
    ##  3     4   0.0158
    ##  4     5   0.0248
    ##  5     6   0.0387
    ##  6     7   0.057 
    ##  7     8   0.0749
    ##  8     9   0.0885
    ##  9    10   0.116 
    ## 10    11   0.140 
    ## # ℹ 39 more rows

``` r
ggplot(prob_by_n, aes(x = n, y = prob_dup)) +
  geom_line() +
  geom_point() +
  labs(
    x = "Group size (n)",
    y = "P(at least two share a birthday)",
    title = "Birthday Duplicate Simulation"
    ) +
  theme_minimal()
```

![](p8105_hw5_rl3616_files/figure-gfm/unnamed-chunk-3-1.png)<!-- --> As
shown in the plot, when the group size is very small, the probability of
having a shared birthday is close to zero. As the group size increases,
the probability rises rapidly. Around a group size of 25, the rate of
increase begins to slow down, and eventually the probability approaches
100%.

### Problem 2

``` r
n <- 30
sigma <- 5
n_sim <- 5000
mu_vec <- 0:6

sim_one_mu <- function(mu, n = 30, sigma = 5, n_sim = 5000) {
  
  map(1:n_sim, {
    x <- rnorm(n, mean = mu, sd = sigma)
    
    t_tidy <- broom::tidy(t.test(x, mu = 0))
    
    tibble(
      mu_true = mu,
      mu_hat = t_tidy$estimate,
      p_value = t_tidy$p.value
    )
  }) |> 
    list_rbind()
}
```
